<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
        <title>Predict loan status</title>
    </head>
    <body>
        <div class="container">
            <div class="row"></div>
            <fieldset>
            <form id="idLoanDataForm">
            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Gender</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="gender" value="Male" checked>
                    <label class="form-check-label">
                        Male
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="gender" value="Female">
                    <label class="form-check-label">
                        Female
                    </label>
                    </div>
                </div>
                </div>
            </fieldset>
            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Married</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="married" value="No" checked>
                    <label class="form-check-label">
                        No
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="married" value="Yes">
                    <label class="form-check-label">
                        Yes
                    </label>
                    </div>
                </div>
                </div>
            </fieldset>
            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Dependents</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="dependents" value="0" checked>
                    <label class="form-check-label">
                        0
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="dependents" value="1">
                    <label class="form-check-label">
                        1
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="dependents" value="2">
                    <label class="form-check-label">
                        2
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="dependents" value="3">
                    <label class="form-check-label">
                        3+
                    </label>
                    </div>
                </div>
                </div>
            </fieldset>
            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Education</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="education" value="Not Graduate" checked>
                    <label class="form-check-label">
                        Not Graduate
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="education" value="Graduate">
                    <label class="form-check-label">
                        Graduate
                    </label>
                    </div>
                </div>
                </div>
            </fieldset>
            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Self-employed</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="self_employed" value="No" checked>
                    <label class="form-check-label">
                        No
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="self_employed" value="Yes">
                    <label class="form-check-label">
                        Yes
                    </label>
                    </div>
                </div>
                </div>
            </fieldset>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Applicant Income</label>
                <div class="col-sm-10">
                <input type="number" class="form-control" name="applicant_income" placeholder="Applicant Income">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Coapplicant Income</label>
                <div class="col-sm-10">
                <input type="number" class="form-control" name="coapplicant_income" placeholder="Coapplicant Income">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Loan Amount</label>
                <div class="col-sm-10">
                <input type="number" class="form-control" name="loan_amount" placeholder="Loan Amount">
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Loan Amount Term</label>
                <div class="col-sm-10">
                <input type="number" class="form-control" name="loan_amount_term" placeholder="Loan Amount Term">
                </div>
            </div>
            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Credit History</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="credit_history" value="0" checked>
                    <label class="form-check-label">
                        No
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="credit_history" value="1">
                    <label class="form-check-label">
                        Yes
                    </label>
                    </div>
                </div>
                </div>
            </fieldset>

            <fieldset class="form-group">
                <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Model</legend>
                <div class="col-sm-10">
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="model" value="bayes" checked>
                    <label class="form-check-label">
                        Bayes
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="model" value="decision_trees">
                    <label class="form-check-label">
                        Decision trees
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="model" value="knn">
                    <label class="form-check-label">
                        KNN
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="model" value="logistic_regression">
                    <label class="form-check-label">
                        Logistic Regression
                    </label>
                    </div>
                    <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="model" value="svm">
                    <label class="form-check-label">
                        SVM
                    </label>
                    </div>

                </div>
                </div>
            </fieldset>
            </form>
            </fieldset>
            <div class="form-group row">
                <label for="idLoanStatus" class="col-sm-2 col-form-label">Loan status</label>
                <div class="col-sm-10">
                <input type="text" class="form-control" id="idLoanStatus" readonly>
                </div>
            </div>
        </div>
        <script>
        document.addEventListener("DOMContentLoaded", function() {
            const loanStatusEl = document.getElementById('idLoanStatus');
            const loanDataFormEl = document.getElementById('idLoanDataForm');

            loanDataFormEl.addEventListener('change', function() {
               // collect data from form inputs
                const data = {};
                for(const inputEl of document.querySelectorAll('form#idLoanDataForm input'))
                {
                    if(inputEl.type == "number") {
                        data[inputEl.name] = inputEl.valueAsNumber || 0;
                    } else if (inputEl.type == "radio") {
                        if(inputEl.checked) {
                            data[inputEl.name] = inputEl.value;
                        }
                    }
                }
                data.dependents = parseInt(data.dependents);
                data.credit_history = parseInt(data.credit_history);
                // send request to api
                // note that this page doesn't need to share the same origin with the API endpoint
                // the same code can be used to issue cross-origin requests (if the url in fetch is changed)
                fetch("/predict_loan_status/", {
                    "credentials": "omit",
                    "headers": {
                        "Content-Type": "application/json",
                    },
                    "body": JSON.stringify(data),
                    "method": "POST",
                })
                .then((response) => response.json())
                .then((data) => {
                    loanStatusEl.value = data.loan_status ? "YES!" : "NO!";
                }).catch((error) => {
                    loanStatusEl.value = "NO!"; // hide error condition
                    console.error("error " + error);
                }).finally(() => {
                    loanDataFormEl.parentElement.disabled = false;
                });
                loanStatusEl.value = "";
                loanDataFormEl.parentElement.disabled = true;
            });
        });
        </script>
    </body>
</html>